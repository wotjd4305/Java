<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      xmlns:th="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title layout:title-pattern="$LAYOUT_TITLE:$CONTENT_TITLE">영업대행</title>
    <th:block th:replace="common/header"></th:block>
</head>
<body>
<header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-black-gradient-custom">
        <a class="navbar-brand" th:href="@{/}"><i class="fas fa-university"></i></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/comp_list}"ethod th:if="${#authentication.principal.details.userRoleId}!='5'"><i class="fas fa-xs fa-handshake"></i> 협력사관리</a>
                    <a class="nav-link" th:href="@{/company/detailComp/}+${#authentication.principal.details.loginId}" th:unless="${#authentication.principal.details.userRoleId}!='5'"><i class="fas fa-xs fa-handshake"></i> 협력사관리</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/store_list}"><i class="fas fa-xs fa-shopping-cart"></i> 상점관리</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown1" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-xs fa-th-list"></i> 상점이력
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" th:href="@{/order_list}">오더현황</a>
                        <a class="dropdown-item" th:href="@{/manage_list}">관리비 현황</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/cal_list}"><i class="fas fa-xs fa-dollar-sign"></i> 정산관리</a>
                </li>
                <li class="nav-item dropdown" sec:authorize="hasRole('ROLE_ADMIN')">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-xs fa-cog"></i> 설정
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item menu_list" th:href="@{/user_list}" target="_parent" id="user_list" name="user_list">계정 관리</a>
                    </div>
                </li>
            </ul>
            <div class="text-center text-white-50 align-middle" sec:authorize="isRememberMe()"></div>
            <div style="text-align: center"><i class="fas fa-xs fa-user-alt mr-1" style="color: whitesmoke;"></i> </div>
            <div class="text-center text-white-50 align-middle" th:text="${#authentication.principal.details.userName}"></div>
            <div class="text-center text-white-50 align-middle" style="margin-right:20px;">(<span th:text="${#authentication.principal.details.webAuth}"></span>)</div>
            <form class="form-inline my-2 my-lg-0" th:action="@{/logout}" method="post">
                <button class="btn btn-outline-nav-custom my-2 my-sm-0 jsLogout">로그아웃</button>
            </form>
        </div>
    </nav>
</header>
<main class="mt-5" style="min-height: 720px;">
    <div layout:fragment="content" th:replace="${content}" id="content"></div>
</main>
<footer th:replace="common/footer"></footer>
</body>
<script th:inline="javascript">
    let token = $("meta[name='_csrf']").attr('content');
    let header = $("meta[name='_csrf_header']").attr('content');

    $(document).ready(function(){

        /*$(".datePicker").datepicker({
            format: "yyyy-mm-dd",	//데이터 포맷 형식(yyyy : 년 mm : 월 dd : 일 )
            autoclose : true,	//사용자가 날짜를 클릭하면 자동 캘린더가 닫히는 옵션
            clearBtn : false, //날짜 선택한 값 초기화 해주는 버튼 보여주는 옵션 기본값 false 보여주려면 true
            disableTouchKeyboard : false,	//모바일에서 플러그인 작동 여부 기본값 false 가 작동 true가 작동 안함.
            immediateUpdates: false,	//사용자가 보는 화면으로 바로바로 날짜를 변경할지 여부 기본값 :false
            templates : {
                leftArrow: '&laquo;',
                rightArrow: '&raquo;'
            }, //다음달 이전달로 넘어가는 화살표 모양 커스텀 마이징
            todayHighlight : true ,	//오늘 날짜에 하이라이팅 기능 기본값 :false
            toggleActive : true,	//이미 선택된 날짜 선택하면 기본값 : false인경우 그대로 유지 true인 경우 날짜 삭제
            language : "ko"	//달력의 언어 선택, 그에 맞는 js로 교체해줘야한다.
        }).on("changeDate", function(e){
            /!*let date = new Date(e.date);
            let str = date.setFullYear(date.getFullYear()+1);
            date = new Date(str);
            let dateFormat = get_date_str(date);
            $("#contractEndDate").val(dateFormat);*!/
        });*/

        $('#schStartDate').datepicker({
            format: "yyyy-mm-dd"
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            console.log(minDate);
            $('#schEndDate').datepicker('setStartDate', minDate);
        });
        $('#schEndDate').datepicker({
            format: "yyyy-mm-dd"
        }).on('changeDate', function (selected) {
            var minDate = new Date(selected.date.valueOf());
            console.log(minDate);
            $('#schStartDate').datepicker('setEndDate', minDate);
        });
    });

    //날짜 포맷 변경 함수 (yyyy-mm-dd)
    function get_date_str(date) {
        let sYear = date.getFullYear();
        let sMonth = date.getMonth() + 1;
        let sDate = date.getDate();
        sMonth = sMonth > 9 ? sMonth : "0" + sMonth;
        sDate = sDate > 9 ? sDate : "0" + sDate;
        return sYear + '-' + sMonth + '-' + sDate;
    }
    /*$(".navbar-item .nav-link").click(function(){
        $(".navbar-item .nav-link").removeClass("active");
        $(this).addClass("active");
    })*/
</script>
</html>